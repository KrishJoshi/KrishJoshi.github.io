---
interface Skill {
  name: string;
  keywords: { icon: string; text: string; filter?: string; companies?: string[] }[];
}

interface Props {
  skills: Skill[];
}

const { skills } = Astro.props;
---

<section class="section-box bg-white dark:bg-gray-800 text-gray-900 dark:text-white p-6 flex flex-col">
  <h2 class="text-2xl md:text-3xl font-black tracking-tight mb-6">TECHNICAL ECOSYSTEM</h2>
  <div class="flex-1">
    {skills.map(category => (
      <div class="mb-5 last:mb-0">
        <div class="text-[10px] font-bold uppercase tracking-widest text-gray-500 dark:text-gray-400 mb-3">{category.name}</div>
        <div class="space-y-1">
          {category.keywords.map(kw => (
            <a
              href={kw.filter ? `#experience?filter=${encodeURIComponent(kw.filter)}` : '#experience'}
              class="skill-item flex items-center gap-3 w-full p-2 -mx-2 rounded-lg hover:bg-gray-100 dark:hover:bg-white/10 transition-all cursor-pointer group"
              data-filter={kw.filter}
              data-companies={kw.companies?.join(',')}
            >
              <span class="material-symbols-outlined text-lg group-hover:scale-110 transition-transform">{kw.icon}</span>
              <span class="text-sm group-hover:text-gray-900 dark:group-hover:text-white transition-colors">{kw.text}</span>
              <span class="material-symbols-outlined text-sm ml-auto opacity-0 group-hover:opacity-100 transition-opacity">arrow_forward</span>
            </a>
          ))}
        </div>
      </div>
    ))}
  </div>
</section>

<script>
  document.querySelectorAll('.skill-item').forEach(item => {
    item.addEventListener('click', (e) => {
      e.preventDefault();
      const filter = (item as HTMLElement).dataset.filter;
      const companies = (item as HTMLElement).dataset.companies?.split(',') || [];

      // Update filter display
      const filterControls = document.getElementById('filter-controls');
      if (filterControls && filter) {
        window.dispatchEvent(new CustomEvent('applyFilter', { detail: { filter, companies } }));
      }

      // Scroll to experience
      document.getElementById('experience-section')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  });
</script>
