---
// View toggle between Interactive and Printable view
---

<div class="fixed bottom-4 left-1/2 -translate-x-1/2 md:bottom-auto md:top-6 md:left-6 md:translate-x-0 z-50 no-print">
  <nav class="view-toggle-nav flex rounded-full shadow-md p-1" role="navigation" aria-label="View mode toggle">
    <button
      id="view-interactive"
      class="view-toggle-btn view-btn-active px-3 py-1.5 md:px-4 md:py-2 rounded-full text-[10px] md:text-xs font-bold uppercase transition-all focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
      data-view="interactive"
      aria-pressed="true"
      type="button"
    >
      Interactive
    </button>
    <button
      id="view-printable"
      class="view-toggle-btn view-btn-inactive px-3 py-1.5 md:px-4 md:py-2 rounded-full text-[10px] md:text-xs font-bold uppercase transition-all focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
      data-view="printable"
      aria-pressed="false"
      type="button"
    >
      Printable
    </button>
  </nav>
</div>

<style is:global>
  /* View toggle nav container */
  .view-toggle-nav {
    background: white;
    border: 1px solid #e5e7eb;
  }
  .dark .view-toggle-nav {
    background: #1e293b;
    border-color: #334155;
  }

  /* Active button - light mode: white bg with dark text, dark mode: dark bg with white text */
  .view-btn-active {
    background: #1a1a1a !important;
    color: white !important;
  }
  .dark .view-btn-active {
    background: white !important;
    color: #1a1a1a !important;
  }

  /* Inactive button */
  .view-btn-inactive {
    background: transparent !important;
    color: #6b7280 !important;
  }
  .view-btn-inactive:hover {
    color: #1a1a1a !important;
  }
  .dark .view-btn-inactive {
    color: #94a3b8 !important;
  }
  .dark .view-btn-inactive:hover {
    color: white !important;
  }
</style>

<script>
  const STORAGE_KEY = 'cv-view-mode';

  function setView(mode: 'interactive' | 'printable') {
    const printableView = document.getElementById('classic-view');
    const interactiveView = document.getElementById('portfolio-view');
    const interactiveBtn = document.getElementById('view-interactive');
    const printableBtn = document.getElementById('view-printable');

    if (mode === 'interactive') {
      printableView?.classList.add('hidden');
      interactiveView?.classList.remove('hidden');
      document.body.classList.add('portfolio-mode');

      interactiveBtn?.classList.add('view-btn-active');
      interactiveBtn?.classList.remove('view-btn-inactive');
      interactiveBtn?.setAttribute('aria-pressed', 'true');

      printableBtn?.classList.remove('view-btn-active');
      printableBtn?.classList.add('view-btn-inactive');
      printableBtn?.setAttribute('aria-pressed', 'false');
    } else {
      printableView?.classList.remove('hidden');
      interactiveView?.classList.add('hidden');
      document.body.classList.remove('portfolio-mode');

      interactiveBtn?.classList.remove('view-btn-active');
      interactiveBtn?.classList.add('view-btn-inactive');
      interactiveBtn?.setAttribute('aria-pressed', 'false');

      printableBtn?.classList.add('view-btn-active');
      printableBtn?.classList.remove('view-btn-inactive');
      printableBtn?.setAttribute('aria-pressed', 'true');
    }

    localStorage.setItem(STORAGE_KEY, mode);
  }

  // Initialize - default to interactive view
  document.addEventListener('DOMContentLoaded', () => {
    const saved = localStorage.getItem(STORAGE_KEY) as 'interactive' | 'printable' | null;
    // Default to interactive if no saved preference
    setView(saved || 'interactive');

    document.querySelectorAll('.view-toggle-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const view = (btn as HTMLElement).dataset.view as 'interactive' | 'printable';
        setView(view);
      });
    });
  });
</script>
