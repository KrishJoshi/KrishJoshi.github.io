---
import Layout from '../layouts/Layout.astro';
import ThemeToggle from '../components/ThemeToggle.astro';
import ViewToggle from '../components/ViewToggle.astro';

// Classic view components
import Header from '../components/Header.astro';
import Achievements from '../components/Achievements.astro';
import Skills from '../components/Skills.astro';
import Profile from '../components/Profile.astro';
import Education from '../components/Education.astro';
import Certifications from '../components/Certifications.astro';
import Experience from '../components/Experience.astro';
import Footer from '../components/Footer.astro';

// Interactive view components
import PortfolioHeader from '../components/PortfolioHeader.astro';
import Philosophy from '../components/Philosophy.astro';
import PortfolioAchievements from '../components/PortfolioAchievements.astro';
import PortfolioSkills from '../components/PortfolioSkills.astro';
import PortfolioExperience from '../components/PortfolioExperience.astro';

import resume from '../data/resume.json';

const { basics, philosophy, achievements, work, skills, education, certificates } = resume;
---

<Layout title={`${basics.name} | ${basics.label}`}>
  <!-- Skip link for keyboard users -->
  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-1/2 focus:-translate-x-1/2 focus:z-[100] focus:px-4 focus:py-2 focus:bg-indigo-600 focus:text-white focus:rounded-lg focus:outline-none">
    Skip to main content
  </a>

  <ThemeToggle />
  <ViewToggle />

  <!-- Printable CV View (hidden by default) -->
  <div id="classic-view" class="hidden max-w-[900px] mx-auto px-6 py-10">
    <Header
      name={basics.name}
      label={basics.label}
      email={basics.email}
      phone={basics.phone}
      location={basics.location}
      profiles={basics.profiles}
    />

    <!-- Row 1: Leadership & Technical Ecosystem -->
    <div class="grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-6 mb-6 items-stretch">
      <Achievements achievements={achievements} />
      <Skills skills={skills} />
    </div>

    <!-- Row 2: Profile & Education/Certifications -->
    <div class="grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-6 mb-6 items-stretch">
      <Profile summary={basics.summary} />
      <div class="space-y-6">
        <Education education={education} />
        <Certifications certificates={certificates} />
      </div>
    </div>

    <!-- Row 3: Experience -->
    <Experience work={work} skills={skills} />

    <Footer location={basics.location} />
  </div>

  <!-- Interactive View (default) -->
  <main id="main-content">
  <div id="portfolio-view" class="max-w-7xl mx-auto px-4 py-8 lg:py-16">
    <!-- Header row: Hero (8 cols) + Status Card (4 cols) -->
    <PortfolioHeader
      name={basics.name}
      label={basics.label}
      headline={basics.headline}
      tagline={basics.tagline}
      email={basics.email}
      availability={basics.availability}
      currentFocus={basics.currentFocus}
      profiles={basics.profiles}
    />

    <!-- Philosophy row: Full width -->
    <Philosophy
      statement={philosophy.statement}
      principles={philosophy.principles}
    />

    <!-- Key Achievements -->
    <PortfolioAchievements achievements={achievements} />

    <!-- Skills with filtering -->
    <PortfolioSkills skills={skills} />

    <!-- Experience section -->
    <PortfolioExperience work={work} />

    <!-- Education & Certs in portfolio style -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <section class="bento-card p-6" aria-labelledby="education-heading">
        <div class="flex items-center gap-2 mb-4">
          <span class="material-symbols-outlined text-indigo-400" aria-hidden="true">school</span>
          <h2 id="education-heading" class="text-lg font-bold text-white">Education</h2>
        </div>
        <ul role="list" aria-label="Educational qualifications">
          {education.map((edu: any) => (
            <li class="flex items-center gap-4 mb-4 last:mb-0">
              <div class="w-12 h-12 bg-slate-800 rounded-xl flex items-center justify-center" aria-hidden="true">
                <span class="material-symbols-outlined text-slate-400">account_balance</span>
              </div>
              <div>
                <div class="font-bold text-white text-sm">{edu.institution}</div>
                <div class="text-xs text-slate-400">{edu.studyType} {edu.area} {edu.score ? `(${edu.score})` : ''}</div>
              </div>
            </li>
          ))}
        </ul>
      </section>

      <section class="bento-card p-6" aria-labelledby="certifications-heading">
        <div class="flex items-center gap-2 mb-4">
          <span class="material-symbols-outlined text-indigo-400" aria-hidden="true">workspace_premium</span>
          <h2 id="certifications-heading" class="text-lg font-bold text-white">Certifications</h2>
        </div>
        <ul role="list" aria-label="Professional certifications">
          {certificates.map((cert: any) => (
            <li class="flex items-center gap-4 mb-4 last:mb-0">
              <div class="w-12 h-12 bg-slate-800 rounded-xl flex items-center justify-center" aria-hidden="true">
                <span class="material-symbols-outlined text-emerald-400">{cert.icon || 'verified'}</span>
              </div>
              <div>
                <div class="font-bold text-white text-sm">{cert.name}</div>
                <div class="text-xs text-slate-400">{cert.issuer} â€¢ {cert.date}</div>
              </div>
            </li>
          ))}
        </ul>
      </section>
    </div>

    <!-- Portfolio Footer -->
    <footer class="mt-16 pt-8 border-t border-slate-700/50" role="contentinfo">
      <div class="flex flex-col md:flex-row justify-between items-center gap-4 text-xs font-semibold tracking-widest text-slate-500 uppercase">
        <span>&copy; {new Date().getFullYear()} {basics.name}</span>
        <span>Built with Astro + Tailwind</span>
        <span>{basics.location.city}, {basics.location.countryCode}</span>
      </div>
    </footer>
  </div>
  </main>
</Layout>
