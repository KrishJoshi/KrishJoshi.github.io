---
import '../styles/global.css'

interface Props {
  title: string;
  description?: string;
}

const { title, description = "Krish Joshi - Principal Engineer & AWS Certified Solution Architect with 14+ years experience in React, Node.js, and cloud-native architectures." } = Astro.props;

// Structured data for SEO
const jsonLd = {
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Krish Joshi",
  "jobTitle": "Principal Engineer & Cloud Architect",
  "description": description,
  "url": "https://krishj.com",
  "email": "me@krishj.com",
  "telephone": "+44 7794 438962",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "London",
    "addressCountry": "UK"
  },
  "sameAs": [
    "https://linkedin.com/in/krishjoshi",
    "https://github.com/KrishJoshi"
  ],
  "knowsAbout": [
    "React", "React Native", "TypeScript", "Node.js", "AWS", "Terraform",
    "Kubernetes", "Cloud Architecture", "AI/ML Integration", "Amazon Bedrock"
  ],
  "hasCredential": [
    {
      "@type": "EducationalOccupationalCredential",
      "name": "AWS Solutions Architect Professional",
      "credentialCategory": "certification"
    },
    {
      "@type": "EducationalOccupationalCredential",
      "name": "Prince2 Agile",
      "credentialCategory": "certification"
    }
  ],
  "alumniOf": {
    "@type": "CollegeOrUniversity",
    "name": "University of Manchester"
  }
};
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Primary Meta Tags -->
  <title>{title}</title>
  <meta name="title" content={title}>
  <meta name="description" content={description}>
  <meta name="author" content="Krish Joshi">
  <meta name="keywords" content="Krish Joshi, Principal Engineer, Cloud Architect, AWS, React, TypeScript, Node.js, London, Software Engineer, Full Stack Developer">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://krishj.com/">
  <meta property="og:title" content={title}>
  <meta property="og:description" content={description}>
  <meta property="og:locale" content="en_GB">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://krishj.com/">
  <meta property="twitter:title" content={title}>
  <meta property="twitter:description" content={description}>

  <!-- Canonical URL -->
  <link rel="canonical" href="https://krishj.com/">

  <!-- Structured Data -->
  <script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap" rel="stylesheet">

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>K</text></svg>">

  <!-- Theme color for mobile browsers -->
  <meta name="theme-color" content="#0f172a" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
</head>
<body class="text-gray-900 font-sans min-h-screen dark:text-gray-100 transition-colors portfolio-mode bg-white dark:bg-gradient-to-br dark:from-slate-900 dark:via-slate-800 dark:to-slate-900">
  <slot />

  <script is:inline>
    // Theme and view mode management - runs immediately to prevent flash
    (function() {
      const THEME_KEY = 'cv-theme-preference';
      const VIEW_KEY = 'cv-view-mode';

      const savedTheme = localStorage.getItem(THEME_KEY);
      if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
      }

      // Handle view mode - default to interactive (portfolio-mode)
      const savedView = localStorage.getItem(VIEW_KEY);
      if (savedView === 'printable') {
        document.body.classList.remove('portfolio-mode');
      }
    })();
  </script>

  <script>
    // Event listeners after DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      const STORAGE_KEY = 'cv-theme-preference';

      document.getElementById('theme-toggle')?.addEventListener('click', () => {
        const isDark = document.documentElement.classList.toggle('dark');
        localStorage.setItem(STORAGE_KEY, isDark ? 'dark' : 'light');
      });

      document.getElementById('print-btn')?.addEventListener('click', () => window.print());
    });
  </script>
</body>
</html>
